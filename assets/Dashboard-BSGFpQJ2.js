import{R as y,j as e,r}from"./index-ClbkNrez.js";import I from"./Loading-Bu7dWlnw.js";const T="₹",S=a=>typeof a=="number"?`${T}${a.toLocaleString()}`:"-",m=[{label:"DDC No.",cols:["ddn","ddc"]},{label:"Claim Month",cols:["claimMonth"]},{label:"Reconciliation Category",cols:["category"]},{label:"ITC Unavailability",cols:["itcUnavailability"]},{label:"Invoice Date",cols:["invoiceDate2b","invoiceDate2p"]},{label:"Invoice Value",cols:["invoiceVal2b","invoiceVal2p"],isCurrency:!0},{label:"Taxable Value",cols:["taxableVal2b","taxableVal2p"],isCurrency:!0},{label:"Tax Amount",cols:["taxAmt2b","taxAmt2p"],isCurrency:!0},{label:"Difference Tax Amount (2P - 2B)",cols:["diffTaxAmount"],isCurrency:!0},{label:"ITC Availability",cols:["itcAvl2b","itcAvl2p"]}],D=({selectedAll:a,handleSelectAll:s,currentInvoices:l,handleSelectRow:i})=>e.jsxs("table",{className:"min-w-full border border-gray-300 text-sm text-gray-700",children:[e.jsxs("thead",{children:[e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{rowSpan:"2",className:"px-2 py-2 border text-center",children:e.jsx("input",{type:"checkbox",checked:a,onChange:s})}),e.jsx("th",{rowSpan:"2",className:"px-2 py-2 border",children:"CTIN"}),m.map((t,c)=>e.jsx("th",{colSpan:t.cols.length,className:"px-2 py-2 border text-center",children:t.label},c))]}),e.jsx("tr",{className:"bg-gray-50",children:m.flatMap((t,c)=>t.cols.map((n,d)=>e.jsx("th",{className:"px-2 py-2 border text-center",children:t.cols.length===1?"":d===0?"2B":"2P"},`${c}-${d}`)))})]}),e.jsx("tbody",{children:l.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-2 py-1 border text-center",children:e.jsx("input",{type:"checkbox",checked:t.selected,onChange:()=>i(t.id)})}),e.jsx("td",{className:"px-2 py-1 border",children:t.ctin}),m.map(c=>c.cols.map(n=>e.jsx("td",{className:"px-2 py-1 border text-center",children:e.jsx("span",{className:t[n]==="MATCHED"||t[n]==="Yes"?"bg-green-100 text-green-800 px-2 py-1 rounded inline-block":"",children:c.isCurrency?S(t[n]):t[n]||"-"})},`col-${n}`)))]},t.id))})]}),E=y.memo(D),M=({currentPage:a,totalPages:s,handlePrev:l,handleNext:i,totalItems:t,itemsPerPage:c=10})=>{const n=(a-1)*c,d=Math.min(n+c,t);return e.jsxs("div",{className:"px-4 py-3 flex justify-between items-center border-t bg-white",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Showing ",n+1,"–",d," of ",t]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{onClick:l,disabled:a===1,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Prev"}),e.jsx("button",{onClick:i,disabled:a===s,className:"px-3 py-1 border rounded disabled:opacity-50",children:"Next"})]})]})},w=y.memo(M);function P(a,s){const[l,i]=r.useState(1),t=Math.ceil(a.length/s),c=(l-1)*s,n=a.slice(c,c+s);return{currentPage:l,totalPages:t,currentData:n,goToNext:()=>i(h=>Math.min(h+1,t)),goToPrev:()=>i(h=>Math.max(h-1,1)),startIndex:c}}const R=()=>Array.from({length:1e4},(a,s)=>({id:`inv_${s+1}`,selected:!1,ctin:`33ASBPG2343M1Z${s<10?"0"+s:s}`,ddn:`DDC${s+100}`,claimMonth:"072024",category:s%3===0?"MATCHED":"PARTIALLY MATCHED",invoiceDate2b:"31-07-2024",invoiceDate2p:"01-08-2024",invoiceVal2b:5e5,invoiceVal2p:5e5,taxableVal2b:4e5,taxableVal2p:4e5,taxAmt2b:72e3,taxAmt2p:72e3,itcAvl2b:s%2===0?"Yes":"No",itcAvl2p:s%4===0?"Yes":"No"})),$=()=>new Promise(a=>{setTimeout(()=>{a({status:"SUCCESS",response:{reconciledInvoices:R()}})},1e3)}),V=10,L=()=>{const[a,s]=r.useState(!1),[l,i]=r.useState([]),[t,c]=r.useState(!0),[n,d]=r.useState(null),{currentPage:u,totalPages:h,currentData:b,goToNext:f,goToPrev:v}=P(l,V),j=l.length,g=r.useMemo(()=>new Set(b.map(x=>x.id)),[b]),N=r.useCallback(()=>{const x=l.map(o=>g.has(o.id)?{...o,selected:!a}:o);i(x),s(o=>!o)},[l,a,g]),C=r.useCallback(x=>{const o=l.map(p=>p.id===x?{...p,selected:!p.selected}:p);i(o)},[l]);return r.useEffect(()=>{(async()=>{try{c(!0),d(null);const p=(await $()).response.reconciledInvoices.map(A=>({...A,selected:!1}));i(p)}catch(o){console.error("Failed to fetch invoices:",o),d(o)}finally{c(!1)}})()},[]),r.useEffect(()=>{const x=b.length>0&&b.every(o=>o.selected);s(x)},[b]),t?e.jsx(I,{}):n?e.jsxs("div",{className:"text-red-500",children:["Error: ",n.message]}):e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"bg-white shadow rounded overflow-x-auto",children:[e.jsx(E,{selectedAll:a,handleSelectAll:N,currentInvoices:b,handleSelectRow:C}),e.jsx(w,{currentPage:u,totalPages:h,handlePrev:v,handleNext:f,totalItems:j})]})})},Y=r.memo(L);export{Y as default};
